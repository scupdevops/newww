(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};!function(a,b){return"undefined"!=typeof module&&null!==module?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define(b):this[a]=b()}("payform",function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return m={},d=/(\d{1,4})/g,m.cards=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:d,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:d,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[0-5]/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:d,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^(62|88)/,format:d,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:d,length:[16],cvcLength:[3],luhn:!0}],b=function(a){var b,c,d,e;for(a=(a+"").replace(/\D/g,""),e=m.cards,c=0,d=e.length;d>c;c++)if(b=e[c],b.pattern.test(a))return b},c=function(a){var b,c,d,e;for(e=m.cards,c=0,d=e.length;d>c;c++)if(b=e[c],b.type===a)return b},l=function(a){var b,c,d,e,f,g;for(d=!0,e=0,c=(a+"").split("").reverse(),f=0,g=c.length;g>f;f++)b=c[f],b=parseInt(b,10),(d=!d)&&(b*=2),b>9&&(b-=9),e+=b;return e%10===0},k=function(a){var b;return null!=("undefined"!=typeof document&&null!==document&&null!=(b=document.selection)?b.createRange:void 0)&&document.selection.createRange().text?!0:a.selectionStart&&a.selectionStart!==a.selectionEnd},q=function(a){return setTimeout(function(){var b;return b=a.target||a.srcElement,b.value=b.value.replace(/\D/g,"")})},o=function(a){return setTimeout(function(){var b,c;return c=a.target||a.srcElement,b=c.selectionStart,c.value=m.formatCardNumber(c.value),null!=b?c.setSelectionRange(b,b):void 0})},h=function(a){var c,d,e,f,g,h,i;return d=String.fromCharCode(a.which),!/^\d+$/.test(d)||(g=a.target||a.srcElement,i=g.value,c=b(i+d),e=(i.replace(/\D/g,"")+d).length,h=16,c&&(h=c.length[c.length.length-1]),e>=h||null!=g.selectionStart&&g.selectionStart!==i.length)?void 0:(f=c&&"amex"===c.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,f.test(i)?(a.preventDefault(),setTimeout(function(){return g.value=i+" "+d})):f.test(i+d)?(a.preventDefault(),setTimeout(function(){return g.value=i+d+" "})):void 0)},e=function(a){var b,c;return b=a.target||a.srcElement,c=b.value,8!==a.which||null!=b.selectionStart&&b.selectionStart!==c.length?void 0:/\d\s$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.value=c.replace(/\d\s$/,"")})):/\s\d?$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.value=c.replace(/\d$/,"")})):void 0},p=function(a){return setTimeout(function(){var b,c;return c=a.target||a.srcElement,b=c.selectionStart,c.value=m.formatCardExpiry(c.value),null!=b?c.setSelectionRange(b,b):void 0})},g=function(a){var b,c,d;return b=String.fromCharCode(a.which),/^\d+$/.test(b)?(c=a.target||a.srcElement,d=c.value+b,/^\d$/.test(d)&&"0"!==d&&"1"!==d?(a.preventDefault(),setTimeout(function(){return c.value="0"+d+" / "})):/^\d\d$/.test(d)?(a.preventDefault(),setTimeout(function(){return c.value=d+" / "})):void 0):void 0},i=function(a){var b,c,d;return b=String.fromCharCode(a.which),/^\d+$/.test(b)?(c=a.target||a.srcElement,d=c.value,/^\d\d$/.test(d)?c.value=d+" / ":void 0):void 0},j=function(a){var b,c,d;return d=String.fromCharCode(a.which),"/"===d||" "===d?(b=a.target||a.srcElement,c=b.value,/^\d$/.test(c)&&"0"!==c?b.value="0"+c+" / ":void 0):void 0},f=function(a){var b,c;return b=a.target||a.srcElement,c=b.value,8!==a.which||null!=b.selectionStart&&b.selectionStart!==c.length?void 0:/\d\s\/\s$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.value=c.replace(/\d\s\/\s$/,"")})):void 0},n=function(a){return setTimeout(function(){var b,c;return c=a.target||a.srcElement,b=c.selectionStart,c.value=c.value.replace(/\D/g,"").slice(0,4),null!=b?c.setSelectionRange(b,b):void 0})},u=function(a){var b;if(!(a.metaKey||a.ctrlKey||0===a.which||a.which<33))return b=String.fromCharCode(a.which),/^\d+$/.test(b)?void 0:a.preventDefault()},s=function(a){var c,d,e,f;return e=a.target||a.srcElement,d=String.fromCharCode(a.which),/^\d+$/.test(d)&&!k(e)?(f=(e.value+d).replace(/\D/g,""),c=b(f),c&&f.length>c.length[c.length.length-1]?a.preventDefault():f.length>16?a.preventDefault():void 0):void 0},t=function(a){var b,c,d;return c=a.target||a.srcElement,b=String.fromCharCode(a.which),/^\d+$/.test(b)&&!k(c)?(d=c.value+b,d=d.replace(/\D/g,""),d.length>6?a.preventDefault():void 0):void 0},r=function(a){var b,c,d;return c=a.target||a.srcElement,b=String.fromCharCode(a.which),k(c)?void 0:(d=c.value+b,d.length>4?a.preventDefault():void 0)},m.cvcInput=function(a){return a.addEventListener("keypress",u),a.addEventListener("keypress",r),a.addEventListener("paste",n),a.addEventListener("change",n),a.addEventListener("input",n)},m.expiryInput=function(a){return a.addEventListener("keypress",u),a.addEventListener("keypress",t),a.addEventListener("keypress",g),a.addEventListener("keypress",j),a.addEventListener("keypress",i),a.addEventListener("keydown",f),a.addEventListener("change",p),a.addEventListener("input",p)},m.cardNumberInput=function(a){return a.addEventListener("keypress",u),a.addEventListener("keypress",s),a.addEventListener("keypress",h),a.addEventListener("keydown",e),a.addEventListener("paste",o),a.addEventListener("change",o),a.addEventListener("input",o)},m.parseCardExpiry=function(a){var b,c,d,e;return a=a.replace(/\s/g,""),e=a.split("/",2),b=e[0],d=e[1],2===(null!=d?d.length:void 0)&&/^\d+$/.test(d)&&(c=(new Date).getFullYear(),c=c.toString().slice(0,2),d=c+d),b=parseInt(b,10),d=parseInt(d,10),{month:b,year:d}},m.validateCardNumber=function(c){var d,e;return c=(c+"").replace(/\s+|-/g,""),/^\d+$/.test(c)?(d=b(c),d?(e=c.length,a.call(d.length,e)>=0&&(d.luhn===!1||l(c))):!1):!1},m.validateCardExpiry=function(a,b){var c,d,e;return"object"==typeof a&&"month"in a&&(e=a,a=e.month,b=e.year),a&&b?(a=String(a).trim(),b=String(b).trim(),/^\d+$/.test(a)&&/^\d+$/.test(b)&&a>=1&&12>=a?(2===b.length&&(b=70>b?"20"+b:"19"+b),4!==b.length?!1:(d=new Date(b,a),c=new Date,d.setMonth(d.getMonth()-1),d.setMonth(d.getMonth()+1,1),d>c)):!1):!1},m.validateCardCVC=function(b,d){var e,f;return b=String(b).trim(),/^\d+$/.test(b)?(e=c(d),null!=e?(f=b.length,a.call(e.cvcLength,f)>=0):b.length>=3&&b.length<=4):!1},m.parseCardType=function(a){var c;return a?(null!=(c=b(a))?c.type:void 0)||null:null},m.formatCardNumber=function(a){var c,d,e,f;return a=a.replace(/\D/g,""),(c=b(a))?(e=c.length[c.length.length-1],a=a.slice(0,e),c.format.global?null!=(f=a.match(c.format))?f.join(" "):void 0:(d=c.format.exec(a),null!=d?(d.shift(),d=d.filter(Boolean),d.join(" ")):void 0)):a},m.formatCardExpiry=function(a){var b,c,d,e;return(c=a.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(b=c[1]||"",d=c[2]||"",e=c[3]||"",(e.length>0||d.length>0&&!/\ \/?\ ?/.test(d))&&(d=" / "),1===b.length&&"0"!==b&&"1"!==b&&(b="0"+b,d=" / "),b+d+e):""},m})}).call(this);